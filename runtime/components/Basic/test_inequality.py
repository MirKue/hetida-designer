import pandas as pd
from .inequality import main


def test_int_int():
    assert main(left=6, right=6)["result"] == False


def test_series_int():
    assert main(
        left=pd.Series(
            {
                "2019-08-01T15:20:12": 1.2,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 0.3,
                "2019-08-05T12:00:34": 0.5,
            }
        ),
        right=1.2,
    )["result"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": False,
                "2019-08-01T15:44:12": True,
                "2019-08-03T16:20:15": True,
                "2019-08-05T12:00:34": True,
            }
        )
    )


def test_df_int():
    assert main(
        left=pd.DataFrame(
            {"a": [1.2, None, 0.3, 0.5], "b": [54.4, 4.3, 21.0, 7.5]},
            index=[
                "2019-08-01T15:20:12",
                "2019-08-01T15:44:12",
                "2019-08-03T16:20:15",
                "2019-08-05T12:00:34",
            ],
        ),
        right=4.3,
    )["result"].equals(
        pd.DataFrame(
            {"a": [True, True, True, True], "b": [True, False, True, True]},
            index=[
                "2019-08-01T15:20:12",
                "2019-08-01T15:44:12",
                "2019-08-03T16:20:15",
                "2019-08-05T12:00:34",
            ],
        )
    )


def test_series_series():
    assert main(
        left=pd.Series(
            {
                "2019-08-01T15:20:12": 1.2,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 0.3,
                "2019-08-05T12:00:34": 0.5,
            }
        ),
        right=pd.Series(
            {
                "2019-08-01T15:20:12": 1.0,
                "2019-08-01T15:44:12": 27,
                "2019-08-03T16:20:15": 0.3,
                "2020-08-05T12:00:34": 17,
                "2021-08-05T12:00:34": None,
            }
        ),
    )["result"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": True,
                "2019-08-01T15:44:12": True,
                "2019-08-03T16:20:15": False,
                "2019-08-05T12:00:34": True,
                "2020-08-05T12:00:34": True,
                "2021-08-05T12:00:34": True,
            }
        )
    )


def test_df_series():
    assert main(
        left=pd.DataFrame(
            {"a": [1.2, None, 0.3, 0.5], "b": [54.4, 4.3, 21.0, 7.5]},
            index=[
                "2019-08-01T15:20:12",
                "2019-08-01T15:44:12",
                "2019-08-03T16:20:15",
                "2019-08-05T12:00:34",
            ],
        ),
        right=pd.Series(
            {
                "2019-08-01T15:20:12": 1.1,
                "2019-08-01T15:44:12": 3.7,
                "2019-08-03T16:20:15": None,
                "2019-08-05T12:00:34": 5,
                "2020-08-05T12:00:34": 10000,
            }
        ),
    )["result"].equals(
        pd.DataFrame(
            {
                "2019-08-01T15:20:12": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "2019-08-01T15:44:12": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "2019-08-03T16:20:15": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "2019-08-05T12:00:34": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "2020-08-05T12:00:34": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "a": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
                "b": {
                    "2019-08-01T15:20:12": True,
                    "2019-08-01T15:44:12": True,
                    "2019-08-03T16:20:15": True,
                    "2019-08-05T12:00:34": True,
                },
            }
        )
    )


def test_empty_series_series():
    assert main(
        left=pd.Series(dtype=float),
        right=pd.Series(
            {
                "2019-08-01T15:20:12": 1.0,
                "2019-08-01T15:44:12": 27,
                "2019-08-03T16:20:15": 3.6,
                "2020-08-05T12:00:34": 17,
                "2021-08-05T12:00:34": None,
            }
        ),
    )["result"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": True,
                "2019-08-01T15:44:12": True,
                "2019-08-03T16:20:15": True,
                "2020-08-05T12:00:34": True,
                "2021-08-05T12:00:34": True,
            }
        )
    )


def test_series_empty_series():
    assert main(
        left=pd.Series(
            {
                "2019-08-01T15:20:12": 1.2,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 0.3,
                "2019-08-05T12:00:34": 0.5,
            }
        ),
        right=pd.Series(dtype=float),
    )["result"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": True,
                "2019-08-01T15:44:12": True,
                "2019-08-03T16:20:15": True,
                "2019-08-05T12:00:34": True,
            }
        )
    )
