import pandas as pd
from .divide import main


def test_numeric():
    assert main(a=16.0, b=4.0)["quotient"] == 4.0


def test_s_numeric():
    assert main(
        a=pd.Series(
            {
                "2019-08-01T15:20:12": 1.2,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 0.3,
                "2019-08-05T12:00:34": 0.5,
            }
        ),
        b=-2,
    )["quotient"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": -0.6,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": -0.15,
                "2019-08-05T12:00:34": -0.25,
            }
        )
    )


def test_s_basic():
    assert main(
        a=pd.Series(
            {
                "2019-08-01T15:20:12": 1.25,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 0.25,
                "2019-08-05T12:00:34": 0.5,
            }
        ),
        b=pd.Series(
            {
                "2019-08-01T15:20:12": 1.0,
                "2019-08-01T15:44:12": 1.25,
                "2019-08-03T16:20:15": 0.25,
                "2019-08-05T12:00:34": 2.0,
            }
        ),
    )["quotient"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": 1.25,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 1.0,
                "2019-08-05T12:00:34": 0.25,
            }
        )
    )


def test_df_basic():
    assert main(
        a=pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": 1.5,
                    "2019-08-01T15:44:12": 7.5,
                    "2019-08-03T16:20:15": 0.5,
                    "2019-08-05T12:00:34": 0.5,
                },
                "b": {
                    "2019-08-01T15:20:12": 7.25,
                    "2019-08-01T15:44:12": 7.0,
                    "2019-08-03T16:20:15": 7.5,
                    "2019-08-05T12:00:34": 7.5,
                },
            }
        ),
        b=pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": 1.5,
                    "2019-08-01T15:44:12": 7.5,
                    "2019-08-03T16:20:15": 0.5,
                    "2019-08-05T12:00:34": 0.5,
                },
                "b": {
                    "2019-08-01T15:20:12": 7.25,
                    "2019-08-01T15:44:12": 7.0,
                    "2019-08-03T16:20:15": 7.5,
                    "2019-08-05T12:00:34": 7.5,
                },
            }
        ),
    )["quotient"].equals(
        pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": 1.0,
                    "2019-08-01T15:44:12": 1.0,
                    "2019-08-03T16:20:15": 1.0,
                    "2019-08-05T12:00:34": 1.0,
                },
                "b": {
                    "2019-08-01T15:20:12": 1.0,
                    "2019-08-01T15:44:12": 1.0,
                    "2019-08-03T16:20:15": 1.0,
                    "2019-08-05T12:00:34": 1.0,
                },
            }
        )
    )
