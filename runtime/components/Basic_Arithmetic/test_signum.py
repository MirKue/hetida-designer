import pandas as pd
from .signum import main


def test_numeric():
    assert main(data=-4)["signum"] == -1


def test_series():
    assert main(
        data=pd.Series(
            {
                "2019-08-01T15:20:12": 4,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": -16,
                "2019-08-05T12:00:34": -0.25,
            }
        )
    )["signum"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": 1,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": -1,
                "2019-08-05T12:00:34": -1,
            }
        )
    )


def test_df():
    assert main(
        data=pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": -4,
                    "2019-08-01T15:44:12": 9,
                    "2019-08-03T16:20:15": 0,
                    "2019-08-05T12:00:34": -1,
                },
                "b": {
                    "2019-08-01T15:20:12": -625,
                    "2019-08-01T15:44:12": -1,
                    "2019-08-03T16:20:15": 0,
                    "2019-08-05T12:00:34": 4,
                },
            }
        )
    )["signum"].equals(
        pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": -1,
                    "2019-08-01T15:44:12": 1,
                    "2019-08-03T16:20:15": 0,
                    "2019-08-05T12:00:34": -1,
                },
                "b": {
                    "2019-08-01T15:20:12": -1,
                    "2019-08-01T15:44:12": -1,
                    "2019-08-03T16:20:15": 0,
                    "2019-08-05T12:00:34": 1,
                },
            }
        )
    )


def test_series_empty():
    assert main(data=pd.Series(dtype=float))["signum"].empty
