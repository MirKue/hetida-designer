import pandas as pd
import numpy as np
import pytest
from .time_to_length import main


def test_basic_speed_series():
    pd.testing.assert_series_equal(
        main(
            data=pd.Series(
                {
                    "2019-08-01T15:20:10": 3.0,
                    "2019-08-01T15:20:11": 22.0,
                    "2019-08-01T15:20:14": 18.0,
                    "2019-08-01T15:20:16": 2.0,
                    "2019-08-01T15:20:18": 7.0,
                    "2019-08-01T15:20:22": 12.0,
                    "2019-08-01T15:20:24": 15.0,
                    "2019-08-01T15:20:26": 18.0,
                }
            ),
            speed=pd.Series(
                {
                    "2019-08-01T15:20:10": 1.0,
                    "2019-08-01T15:20:11": 3.0,
                    "2019-08-01T15:20:14": 4.0,
                    "2019-08-01T15:20:16": 2.0,
                    "2019-08-01T15:20:18": 1.0,
                    "2019-08-01T15:20:22": 2.0,
                    "2019-08-01T15:20:24": 4.0,
                    "2019-08-01T15:20:26": 5.0,
                }
            ),
        )["result"],
        pd.Series(
            [3.0, 22.0, 18.0, 2.0, 7.0, 12.0, 15.0, 18.0],
            index=[0.0, 2.0, 12.5, 18.5, 21.5, 27.5, 33.5, 42.5],
        ),
    )


def test_basic_speed_float():
    pd.testing.assert_series_equal(
        main(
            data=pd.Series(
                {
                    "2019-08-01T15:20:10": 3.0,
                    "2019-08-01T15:20:11": 22.0,
                    "2019-08-01T15:20:14": 18.0,
                    "2019-08-01T15:20:16": 2.0,
                    "2019-08-01T15:20:18": 7.0,
                    "2019-08-01T15:20:22": 12.0,
                    "2019-08-01T15:20:24": 15.0,
                    "2019-08-01T15:20:26": 18.0,
                }
            ),
            speed=5,
        )["result"],
        pd.Series(
            [3.0, 22.0, 18.0, 2.0, 7.0, 12.0, 15.0, 18.0],
            index=[0.0, 5.0, 20.0, 30.0, 40.0, 60.0, 70.0, 80.0],
        ),
    )


def test_speed_series_zero():
    pd.testing.assert_series_equal(
        main(
            data=pd.Series(
                {
                    "2019-08-01T15:20:10": 3.0,
                    "2019-08-01T15:20:11": 22.0,
                    "2019-08-01T15:20:14": 18.0,
                    "2019-08-01T15:20:16": 2.0,
                    "2019-08-01T15:20:18": 7.0,
                    "2019-08-01T15:20:22": 12.0,
                    "2019-08-01T15:20:24": 15.0,
                    "2019-08-01T15:20:26": 18.0,
                }
            ),
            speed=pd.Series(
                {
                    "2019-08-01T15:20:10": 1.0,
                    "2019-08-01T15:20:11": 3.0,
                    "2019-08-01T15:20:14": 0.0,
                    "2019-08-01T15:20:16": 0.0,
                    "2019-08-01T15:20:18": 2.0,
                    "2019-08-01T15:20:22": 2.0,
                    "2019-08-01T15:20:24": 4.0,
                    "2019-08-01T15:20:26": 5.0,
                }
            ),
        )["result"],
        pd.Series(
            [3.0, 22.0, 18.0, 2.0, 7.0, 12.0, 15.0, 18.0],
            index=[0.0, 2.0, 6.5, 6.5, 8.5, 16.5, 22.5, 31.5],
        ),
    )

