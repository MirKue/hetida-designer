import pandas as pd
import math
from .modulo import main


def test_float():
    assert main(a=25, b=3)["modulo"] == 1


def test_series():
    assert main(
        a=pd.Series(
            {
                "2019-08-01T15:20:12": 9,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 47.0,
                "2019-08-05T12:00:34": -8.0,
            }
        ),
        b=4,
    )["modulo"].equals(
        pd.Series(
            {
                "2019-08-01T15:20:12": 1,
                "2019-08-01T15:44:12": None,
                "2019-08-03T16:20:15": 3.0,
                "2019-08-05T12:00:34": 0.0,
            }
        )
    )


def test_df():
    assert main(
        a=pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": 3,
                    "2019-08-01T15:44:12": 7,
                    "2019-08-03T16:20:15": -3,
                    "2019-08-05T12:00:34": 2,
                },
                "b": {
                    "2019-08-01T15:20:12": 0,
                    "2019-08-01T15:44:12": 4,
                    "2019-08-03T16:20:15": 5,
                    "2019-08-05T12:00:34": 7,
                },
            }
        ),
        b=2,
    )["modulo"].equals(
        pd.DataFrame(
            {
                "a": {
                    "2019-08-01T15:20:12": 1,
                    "2019-08-01T15:44:12": 1,
                    "2019-08-03T16:20:15": 1,
                    "2019-08-05T12:00:34": 0,
                },
                "b": {
                    "2019-08-01T15:20:12": 0,
                    "2019-08-01T15:44:12": 0,
                    "2019-08-03T16:20:15": 1,
                    "2019-08-05T12:00:34": 1,
                },
            }
        )
    )


def test_empty_series_series():
    assert main(a=pd.Series(dtype=float), b=5)["modulo"].empty

